#!/usr/bin/env python

import sys
import xml.etree.ElementTree as ET

ATOM = "http://www.w3.org/2005/Atom"
ARXIV = "http://arxiv.org/schemas/atom"
NS = {"a": ATOM, "arxiv": ARXIV}


def q(ns, tag):
    return f"{{{ns}}}{tag}"


data = sys.stdin.buffer.read()
if not data:
    sys.exit(0)
try:
    root = ET.fromstring(data)
except ET.ParseError:
    sys.stdout.buffer.write(data)
    sys.exit(0)

for entry in root.findall("a:entry", NS):
    c = entry.find("arxiv:comment", NS)
    if c is None:
        continue
    ctext = (c.text or "").strip()
    if not ctext:
        continue
    summary = entry.find("a:summary", NS)
    if summary is None:
        continue

    orig = (summary.text or "").strip()
    summary.text = f"(arXiv comment: {ctext})\n\n{orig}"

ET.register_namespace("", ATOM)
ET.register_namespace("arxiv", ARXIV)
sys.stdout.buffer.write(ET.tostring(root, encoding="utf-8", xml_declaration=True))
